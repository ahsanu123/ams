import{c as E}from"./create-split-props-u5h9OPvL.js";import{e as P,bf as g,G as f,r as N,P as v,a1 as y,a as A,am as U,ag as M}from"./Toaster-D9QYH5nK.js";import{a as d}from"./chunk-K6CSEXPM-Bn6mf80d.js";const D=e=>E()(e,["immediate","lazyMount","onExitComplete","present","skipAnimationOnMount","unmountOnExit"]);function O(e,t){const{state:i,send:o,context:n}=e,s=i.matches("mounted","unmountSuspended");return{skip:!n.get("initial"),present:s,setNode(a){a&&o({type:"NODE.SET",node:a})},unmount(){o({type:"UNMOUNT"})}}}var C=P({props({props:e}){return{...e,present:!!e.present}},initialState({prop:e}){return e("present")?"mounted":"unmounted"},refs(){return{node:null,styles:null}},context({bindable:e}){return{unmountAnimationName:e(()=>({defaultValue:null})),prevAnimationName:e(()=>({defaultValue:null})),present:e(()=>({defaultValue:!1})),initial:e(()=>({sync:!0,defaultValue:!1}))}},exit:["clearInitial","cleanupNode"],watch({track:e,prop:t,send:i}){e([()=>t("present")],()=>{i({type:"PRESENCE.CHANGED"})})},on:{"NODE.SET":{actions:["setupNode"]},"PRESENCE.CHANGED":{actions:["setInitial","syncPresence"]}},states:{mounted:{on:{UNMOUNT:{target:"unmounted",actions:["clearPrevAnimationName","invokeOnExitComplete"]},"UNMOUNT.SUSPEND":{target:"unmountSuspended"}}},unmountSuspended:{effects:["trackAnimationEvents"],on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]},UNMOUNT:{target:"unmounted",actions:["clearPrevAnimationName","invokeOnExitComplete"]}}},unmounted:{on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]}}}},implementations:{actions:{setInitial:({context:e})=>{e.get("initial")||queueMicrotask(()=>{e.set("initial",!0)})},clearInitial:({context:e})=>{e.set("initial",!1)},invokeOnExitComplete:({prop:e})=>{var t;(t=e("onExitComplete"))==null||t()},setupNode:({refs:e,event:t})=>{e.get("node")!==t.node&&(e.set("node",t.node),e.set("styles",v(t.node)))},cleanupNode:({refs:e})=>{e.set("node",null),e.set("styles",null)},syncPresence:({context:e,refs:t,send:i,prop:o})=>{const n=o("present");if(n)return i({type:"MOUNT",src:"presence.changed"});const s=t.get("node");if(!n&&(s==null?void 0:s.ownerDocument.visibilityState)==="hidden")return i({type:"UNMOUNT",src:"visibilitychange"});N(()=>{var m,r;const a=l(t.get("styles"));e.set("unmountAnimationName",a),a==="none"||a===e.get("prevAnimationName")||((m=t.get("styles"))==null?void 0:m.display)==="none"||((r=t.get("styles"))==null?void 0:r.animationDuration)==="0s"?i({type:"UNMOUNT",src:"presence.changed"}):i({type:"UNMOUNT.SUSPEND"})})},setPrevAnimationName:({context:e,refs:t})=>{N(()=>{e.set("prevAnimationName",l(t.get("styles")))})},clearPrevAnimationName:({context:e})=>{e.set("prevAnimationName",null)}},effects:{trackAnimationEvents:({context:e,refs:t,send:i,prop:o})=>{const n=t.get("node");if(!n)return;const s=r=>{var c,p;(((p=(c=r.composedPath)==null?void 0:c.call(r))==null?void 0:p[0])??r.target)===n&&e.set("prevAnimationName",l(t.get("styles")))},a=r=>{const u=l(t.get("styles"));y(r)===n&&u===e.get("unmountAnimationName")&&!o("present")&&i({type:"UNMOUNT",src:"animationend"})};n.addEventListener("animationstart",s),n.addEventListener("animationcancel",a),n.addEventListener("animationend",a);const m=g(n,{animationFillMode:"forwards"});return()=>{n.removeEventListener("animationstart",s),n.removeEventListener("animationcancel",a),n.removeEventListener("animationend",a),f(()=>m())}}}}});function l(e){return(e==null?void 0:e.animationName)||"none"}A()(["onExitComplete","present","immediate"]);function S(e,t={}){const{sync:i=!1}=t,o=x(e);return d.useCallback((...n)=>{var s;return i?queueMicrotask(()=>{var a;return(a=o.current)==null?void 0:a.call(o,...n)}):(s=o.current)==null?void 0:s.call(o,...n)},[i,o])}function x(e){const t=d.useRef(e);return t.current=e,t}const L=(e={})=>{const{lazyMount:t,unmountOnExit:i,present:o,skipAnimationOnMount:n=!1,...s}=e,a=d.useRef(!1),m={...s,present:o,onExitComplete:S(e.onExitComplete)},r=U(C,m),u=O(r);u.present&&(a.current=!0);const c=!u.present&&!a.current&&t||i&&!u.present&&a.current,p=()=>({"data-state":u.skip&&n?void 0:o?"open":"closed",hidden:!u.present});return{ref:u.setNode,getPresenceProps:p,present:u.present,unmounted:c}},[w,I]=M({name:"PresenceContext",hookName:"usePresenceContext",providerName:"<PresenceProvider />"});export{w as P,L as a,D as s,I as u};
