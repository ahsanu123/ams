import{e as Y,S}from"./stack-CD8du1Wu.js";import{a as H,n as e}from"./chunk-K6CSEXPM-Bn6mf80d.js";import{E as K}from"./header-information-contant-B3N2sSri.js";import"./query-client-B-np7aBl.js";import{c as E,b as x,p as y,e as Q,d as j,A as h,a as G}from"./user-management-api-CbimgFC6.js";import{u as V}from"./customer-money-api-DmVklbqs.js";import{u as J}from"./QueryClientProvider-DhxQ09mG.js";import{D as z,S as b,T as k,a as B,b as P,c as i,d as I,e as c,B as _}from"./Scroller-vb5K4257.js";import{u as W}from"./main-layout-state-74XbQ8nQ.js";import{ae as X}from"./Toaster-D9QYH5nK.js";import{d as M}from"./DataListUtil-DLK3g0eA.js";import{F as Z,f as T}from"./format-date-id-D-ORLjoU.js";import{C as ee,a as te,b as ae,f as m}from"./format-as-rupiah-C_Lq9mCl.js";import{c as ne,S as se,a as re,b as oe,d as ie,e as ce,f as de,g as le,h as me,i as ue,D as ye}from"./index.es-BK2oozlO.js";import{k as he,l as pe,B as xe}from"./index-NHkl8kqz.js";import{H as f,T as ge}from"./index-BGCzkhMS.js";import{I as je}from"./image-DFImKJsQ.js";import"./Scroller-BcfPVuNP.js";import"./create-split-props-u5h9OPvL.js";import"./index-BmMpWGiz.js";import"./index-COO_Jjqm.js";import"./isSameDay-BShgF_mc.js";const Pe="/payment/get-month-summary",fe="/payment/get-payment-record",Re="/payment/get-payment-record-by-user-id-and-month",Se="/payment/update-bulk-payment-record",Me="/payment/update-payment-record",Te={getPaymentRecord:async function(s){const o=await y(`${h}${fe}`,{userId:s});return j(o)},getMonthSummary:async function(s){const o=await y(`${h}${Pe}`,{date:s});return j(o)},getPaymentRecordByUserIdAndMonth:async function(s,o){const n=await y(`${h}${Re}`,{date:o,userId:s});return j(n)},updatePaymentRecord:async function(s){const o=await y(`${h}${Me}`,{record:s});return j(o)},updateBulkPaymentRecord:async function(s,o){const n=await y(`${h}${Se}`,{records:s,paid:o});return Q(n)}},p=Te;function Ce(){const s=J();return{getMonthSummary:a=>x({queryKey:["getMonthSummary "],queryFn:()=>p.getMonthSummary(a)}),getPaymentRecord:a=>x({queryKey:["getPaymentRecord "],queryFn:()=>p.getPaymentRecord(a)}),getPaymentRecordByUserIdAndMonth:(a,d)=>({queryKey:["getPaymentRecordByUserIdAndMonth",a,d],queryFn:()=>p.getPaymentRecordByUserIdAndMonth(a,d),enabled:!!a&&!!d}),updateBulkPaymentRecord:(a,d)=>E({onSuccess:()=>s.invalidateQueries({queryKey:["getPaymentRecord"]}),mutationFn:()=>p.updateBulkPaymentRecord(a,d)}),updatePaymentRecord:a=>E({onSuccess:()=>s.invalidateQueries({queryKey:["getPaymentRecord"]}),mutationFn:()=>p.updatePaymentRecord(a)})}}const u=he()(pe((s,o)=>({paymentRecords:[],setPaymentRecords:n=>{s(r=>{r.paymentRecords=n})},moneyHistories:[],setMoneyHistories:n=>{s(r=>{r.moneyHistories=n})},pageModel:void 0,setPageModel:n=>{s(r=>{r.pageModel=n})},showDetailTaking:!1,setShowDetailTaking:n=>{s(r=>{r.showDetailTaking=n})},selectedDate:void 0,setSelectedDate:n=>{s(r=>{r.selectedDate=n})},selectedCustomer:void 0,setSelectedCustomer:n=>{s(r=>{r.selectedCustomer=n})},listCustomer:[],setListCustomer:n=>{s(r=>{r.listCustomer=n})},dateSelectorEnabled:!1}))),Ve=Y(function(){const{getAllUser:o}=G(),{data:n}=x(o),r=W(t=>t.setHeaderInformation),R=u(t=>t.listCustomer),C=u(t=>t.setListCustomer),a=u(t=>t.selectedCustomer),d=u(t=>t.setSelectedCustomer),g=u(t=>t.selectedDate),U=u(t=>t.setSelectedDate),{getAllUserMoneyHistory:L}=V(),{getPaymentRecordByUserIdAndMonth:N}=Ce(),{data:A,refetch:w}=x(L(a==null?void 0:a.id)),{data:l,refetch:v}=x(N(a==null?void 0:a.id,g)),D=ne({items:R.map(t=>({label:t.username,value:t.id.toString()}))}),$=()=>e.jsxs(S,{maxWidth:"1000px",children:[q(),F()]}),q=()=>e.jsx(b,{title:`Catatan Uang ${a==null?void 0:a.username}`,maxHeight:"350px",children:e.jsxs(k,{stickyHeader:!0,children:[e.jsx(B,{children:e.jsxs(P,{children:[e.jsx(i,{children:"Tanggal"}),e.jsx(i,{children:"Jumlah uang"}),e.jsx(i,{children:"Keterangan"})]})}),e.jsx(I,{children:A&&A.map(t=>e.jsxs(P,{children:[e.jsx(c,{children:T(t.date)}),e.jsx(c,{children:m(t.moneyAmount)}),e.jsxs(c,{children:[t.description.toLocaleLowerCase().includes("paying")||t.description.toLocaleLowerCase().includes("Dept")?e.jsx(_,{colorPalette:"green",children:"Pay"}):e.jsx(_,{colorPalette:"blue",children:"Add"})," ",t.description]})]}))})]})}),F=()=>e.jsx(b,{title:`Catatan Pembayaran ${a==null?void 0:a.username}`,maxHeight:"350px",children:e.jsxs(k,{stickyHeader:!0,children:[e.jsx(B,{children:e.jsxs(P,{children:[e.jsx(i,{children:"Tanggal"}),e.jsx(i,{children:"Tagihan"}),e.jsx(i,{children:"Penambahan uang"}),e.jsx(i,{children:"Uang Awal"}),e.jsx(i,{children:"Uang Akhir"})]})}),e.jsx(I,{children:l&&l.map(t=>e.jsxs(P,{colorPalette:"green",children:[e.jsx(c,{children:T(t.date)}),e.jsx(c,{children:m(t.billAmount)}),e.jsx(c,{children:m(t.addedMoney)}),e.jsx(c,{children:m(t.initialMoney)}),e.jsx(c,{children:m(t.endMoney)})]}))})]})});return H.useEffect(()=>(n&&(C(n),r({title:"List Payment",description:"Place To See All Taking Record"})),()=>r(K)),[n]),H.useEffect(()=>{v(),w()},[g,a]),e.jsx(xe,{className:"list-payment-page",children:e.jsxs(Z,{className:"flex-left-and-right",children:[e.jsxs(S,{className:"name-and-date-picker",children:[e.jsx(f,{children:"Pilih Nama"}),e.jsxs(se,{size:"lg",value:a?[a.id.toString()]:[],collection:D,onValueChange:t=>{t.value[0]!==void 0&&d(R.find(O=>O.id===Number(t.value[0])))},children:[e.jsx(re,{}),e.jsx(oe,{children:e.jsx(ie,{textStyle:"lg",children:e.jsx(ce,{placeholder:"Pilih Nama"})})}),e.jsx(X,{children:e.jsx(de,{children:e.jsx(le,{children:D.items.map(t=>e.jsxs(me,{item:t,children:[e.jsx(ge,{textStyle:"lg",children:t.label}),e.jsx(ue,{})]},t.value))})})})]}),a&&e.jsxs(ee,{children:[e.jsx(te,{children:e.jsxs(f,{children:["Data ",a.username]})}),e.jsx(ae,{children:e.jsxs(z,{children:[M("Status",a.isActive?"Aktif":"Tidak Aktif"),M("Uang Saat Ini",m(a.money)),M("Pelanggan Sejak",T(a.createdDate))]})})]}),e.jsx(f,{children:"Pilih Bulan dan Tahun"}),e.jsx(ye,{inline:!0,placeholderText:"Bulan Dan Tahun",dateFormat:"MMMM yyyy ",selected:g,onChange:t=>t&&U(t),showMonthYearPicker:!0})]}),l&&l.length>0&&$(),g&&a&&l&&l.length<=0&&e.jsxs(S,{alignItems:"center",children:[e.jsx(f,{children:"Tidak Ada Data"}),e.jsx(je,{src:"/ams-hero-2.png"})]})]})})});export{Ve as default};
