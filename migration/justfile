# NOTE: 
# delete sqlite file before run `mage` command

# run migration and seed data
mig-and-seed:
  echo "todo"

# migrate and generate entity
mage:
  just delete-database-file
  just run 
  just delete-old-entity
  just gen-entity

delete-old-entity: 
  find ./../entity/ -type f \
    ! -name 'Cargo.toml' \
    ! -name 'Cargo.lock' \
    ! -name '.gitignore' \
    -delete

# will run migration up
run: 
  RUST_BACKTRACE=1 cargo run

gen-entity:
  DATABASE_URL=sqlite://../app/src-tauri/ams.sqlite?mode=rwc sea-orm-cli generate entity  -o ./../entity/ --lib

delete-database-file:
  rm ../app/src-tauri/ams.sqlite

copy-to-api: 
  cp ../app/src-tauri/ams.sqlite ../api/
